namespace = acot_herculean_events

#################### HERCULEAN SYSTEMS

# PROMPT
country_event = {
	id = acot_herculean_events.1
	title = acot_herculean_events.1.name
	desc = acot_herculean_events.1.desc
	picture = GFX_evt_physics_research
	show_sound = event_mystery

	mean_time_to_happen = {
		years = 2
	}

	trigger = {
		has_technology = tech_precursor_design
		has_technology = tech_precursor_citadel
		NOR = {
			has_technology = tech_precursor_colossus
			has_country_flag = acot_herculean_rumor_heard
		}
		NOT = {
			has_global_flag = acot_herculean_forbidden
		}
	}
	
	immediate = {
		set_country_flag = acot_herculean_rumor_heard
	}
	
	option = {
		name = acot_herculean_events.1.a
		trigger = {
			is_ai = no
		}
		begin_event_chain = {
			event_chain = acot_herculean_development_chain
		}
		capital_scope = {
			create_point_of_interest = {
				id = acot_herculean_poi.1
				name = acot_herculean_poi.1.name
				desc = acot_herculean_poi.1.desc
				event_chain = acot_herculean_development_chain
				location = this
			}		
		}
		hidden_effect = {
			country_event = {
				id = acot_herculean_events.2
			}
		}
    }

	option = {
		name = acot_herculean_events.1.c
    }

	### FOR AI
	option = {
		name = acot_herculean_events.1.a
		trigger = {
			is_ai = yes
			NOT = {
				has_global_flag = acot_ai_simple_event_forbidden
			}
		}
		begin_event_chain = {
			event_chain = acot_herculean_development_chain
		}
		hidden_effect = {
			country_event = {
				id = acot_herculean_events.2
			}
		}
    }

	option = {
		name = acot_herculean_events.1.a
		trigger = {
			is_ai = yes
			has_global_flag = acot_ai_simple_event_forbidden
		}
		begin_event_chain = {
			event_chain = acot_herculean_development_chain
		}
		capital_scope = {
			create_point_of_interest = {
				id = acot_herculean_poi.1
				name = acot_herculean_poi.1.name
				desc = acot_herculean_poi.1.desc
				event_chain = acot_herculean_development_chain
				location = this
			}		
		}
		enable_special_project = {
			name = ACOT_HERCULEAN_PHYSICS_STUDY
		}
		enable_special_project = {
			name = ACOT_HERCULEAN_SOCIETY_STUDY
		}
		enable_special_project = {
			name = ACOT_HERCULEAN_ENGINEER_STUDY
		}
		hidden_effect = {
		}
    }
}

#### CONTACT
country_event = {
	id = acot_herculean_events.2
	title = acot_precursor_databank.3.name
	desc = acot_herculean_events.2.desc
	
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	is_triggered_only = yes

	picture_event_data = {
		room = acot_sophia_room
		portrait = event_target:acot_sophia_ruler
	}
	

	immediate = {
		set_country_flag = acot_databank_diplomacy_engaged
	}

	after = {
	}
	
	option = {
		name = acot_herculean_events.2.a
		response_text = acot_herculean_events.2.a.response
		is_dialog_only = yes
	}

	option = {
		name = acot_herculean_events.2.b
		response_text = acot_herculean_events.2.b.response
		is_dialog_only = yes
	}

	option = {
		name = acot_herculean_events.2.c
		response_text = acot_herculean_events.2.c.response
		is_dialog_only = yes
	}

	option = {
		name = acot_herculean_events.2.d
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = acot_databank_diplomacy_engaged
			country_event = {
				id = acot_herculean_events.3
			}
		}
	}

	option = {
		name = acot_herculean_events.2.e
		custom_tooltip = acot_herculean_events.2.e.response
		end_event_chain = acot_herculean_development_chain
		hidden_effect = {
			remove_country_flag = acot_databank_diplomacy_engaged
		}
	}	
}

#### CONTACT
country_event = {
	id = acot_herculean_events.3
	title = acot_precursor_databank.3.name
	desc = acot_herculean_events.3.desc
	
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	is_triggered_only = yes

	picture_event_data = {
		room = acot_sophia_room
		portrait = event_target:acot_sophia_ruler
	}
	

	immediate = {
		set_country_flag = acot_databank_diplomacy_engaged
	}

	after = {
	}
	
	option = {
		name = acot_herculean_events.3.a
		response_text = acot_herculean_events.3.a.response
		is_dialog_only = yes
	}

	option = {
		name = acot_herculean_events.3.b
		response_text = acot_herculean_events.3.b.response
		hidden_effect = {
			remove_country_flag = acot_databank_diplomacy_engaged
			begin_event_chain = {
				event_chain = acot_herculean_development_chain
			}
			enable_special_project = {
				name = ACOT_HERCULEAN_PHYSICS_STUDY
			}
			enable_special_project = {
				name = ACOT_HERCULEAN_SOCIETY_STUDY
			}
			enable_special_project = {
				name = ACOT_HERCULEAN_ENGINEER_STUDY
			}
		}
	}

	option = {
		name = acot_herculean_events.3.c
		response_text = acot_herculean_events.3.c.response
		end_event_chain = acot_herculean_development_chain
		hidden_effect = {
			remove_country_flag = acot_databank_diplomacy_engaged
		}
	}

}

########### DORAEMON FOR PROJECT EVENTS PHYSICS

country_event = {
	id = acot_herculean_events.300
	title = acot_herculean_events.300.name
	desc = acot_herculean_events.300.desc
	picture = GFX_evt_acot_greetings
	show_sound = event_mystery
	is_triggered_only = yes

	trigger = {
	}
	
	immediate = {
	}
	
	option = {
		name = acot_herculean_events.300.a
    }
}

country_event = {
	id = acot_herculean_events.301
	title = acot_herculean_events.301.name
	desc = acot_herculean_events.301.desc
	picture = GFX_evt_acot_greetings
	show_sound = event_mystery
	is_triggered_only = yes

	trigger = {
	}
	
	immediate = {
	}
	
	option = {
		name = acot_herculean_events.301.a
    }
}

country_event = {
	id = acot_herculean_events.302
	title = acot_herculean_events.302.name
	desc = acot_herculean_events.302.desc
	picture = GFX_evt_acot_greetings
	show_sound = event_mystery
	is_triggered_only = yes

	trigger = {
	}
	
	immediate = {
	}
	
	option = {
		name = acot_herculean_events.302.a
    }
}

country_event = {
	id = acot_herculean_events.303
	title = acot_herculean_events.303.name
	desc = acot_herculean_events.303.desc
	picture = GFX_evt_acot_greetings
	show_sound = event_mystery
	is_triggered_only = yes

	trigger = {
	}
	
	immediate = {
		set_country_flag = acot_herculean_physics_completed
	}
	
	option = {
		name = acot_herculean_events.303.a
    }

	after = {
		IF = {
			limit = {
				has_country_flag = acot_herculean_physics_completed
				has_country_flag = acot_herculean_engineer_completed
				has_country_flag = acot_herculean_society_completed
			}
			hidden_effect = {
				country_event = {
					id = acot_herculean_events.330 days = 2
				}
			}
		}
	}
}

########### DORAEMON FOR PROJECT EVENTS SORCERY

country_event = {
	id = acot_herculean_events.310
	title = acot_herculean_events.310.name
	desc = acot_herculean_events.310.desc
	picture = GFX_evt_acot_greetings
	show_sound = event_mystery
	is_triggered_only = yes

	trigger = {
	}
	
	immediate = {
	}
	
	option = {
		name = acot_herculean_events.310.a
    }
}

country_event = {
	id = acot_herculean_events.311
	title = acot_herculean_events.311.name
	desc = acot_herculean_events.311.desc
	picture = GFX_evt_acot_greetings
	show_sound = event_mystery
	is_triggered_only = yes

	trigger = {
	}
	
	immediate = {
	}
	
	option = {
		name = acot_herculean_events.311.a
    }
}

country_event = {
	id = acot_herculean_events.312
	title = acot_herculean_events.312.name
	desc = acot_herculean_events.312.desc
	picture = GFX_evt_acot_greetings
	show_sound = event_mystery
	is_triggered_only = yes

	trigger = {
	}
	
	immediate = {
	}
	
	option = {
		name = acot_herculean_events.312.a
    }
}

country_event = {
	id = acot_herculean_events.313
	title = acot_herculean_events.313.name
	desc = acot_herculean_events.313.desc
	picture = GFX_evt_acot_greetings
	show_sound = event_mystery
	is_triggered_only = yes

	trigger = {
	}
	
	immediate = {
		set_country_flag = acot_herculean_society_completed
	}
	
	option = {
		name = acot_herculean_events.313.a
    }

	after = {
		IF = {
			limit = {
				has_country_flag = acot_herculean_physics_completed
				has_country_flag = acot_herculean_engineer_completed
				has_country_flag = acot_herculean_society_completed
			}
			hidden_effect = {
				country_event = {
					id = acot_herculean_events.330 days = 2
				}
			}
		}
	}
}

########### DORAEMON FOR PROJECT EVENTS ENGINSSER

country_event = {
	id = acot_herculean_events.320
	title = acot_herculean_events.320.name
	desc = acot_herculean_events.320.desc
	picture = GFX_evt_acot_greetings
	show_sound = event_mystery
	is_triggered_only = yes

	trigger = {
	}
	
	immediate = {
	}
	
	option = {
		name = acot_herculean_events.320.a
    }
}

country_event = {
	id = acot_herculean_events.321
	title = acot_herculean_events.321.name
	desc = acot_herculean_events.321.desc
	picture = GFX_evt_acot_greetings
	show_sound = event_mystery
	is_triggered_only = yes

	trigger = {
	}
	
	immediate = {
	}
	
	option = {
		name = acot_herculean_events.321.a
    }
}

country_event = {
	id = acot_herculean_events.322
	title = acot_herculean_events.322.name
	desc = acot_herculean_events.322.desc
	picture = GFX_evt_acot_greetings
	show_sound = event_mystery
	is_triggered_only = yes

	trigger = {
	}
	
	immediate = {
	}
	
	option = {
		name = acot_herculean_events.322.a
    }
}

country_event = {
	id = acot_herculean_events.323
	title = acot_herculean_events.323.name
	desc = acot_herculean_events.323.desc
	picture = GFX_evt_acot_greetings
	show_sound = event_mystery
	is_triggered_only = yes

	trigger = {
	}
	
	immediate = {
		set_country_flag = acot_herculean_engineer_completed
	}
	
	option = {
		name = acot_herculean_events.323.a
    }

	after = {
		IF = {
			limit = {
				has_country_flag = acot_herculean_physics_completed
				has_country_flag = acot_herculean_engineer_completed
				has_country_flag = acot_herculean_society_completed
			}
			hidden_effect = {
				country_event = {
					id = acot_herculean_events.330 days = 2
				}
			}
		}
	}
}

########### READY FOR PRECURSOR RESEARCH

country_event = {
	id = acot_herculean_events.330
	title = acot_herculean_events.330.name
	desc = acot_herculean_events.330.desc
	picture = GFX_evt_acot_greetings
	show_sound = event_mystery
	is_triggered_only = yes

	trigger = {
	}
	
	immediate = {
		remove_point_of_interest = acot_herculean_poi.1
	}
	
	option = {
		name = acot_herculean_events.330.a
		capital_scope = {
			create_point_of_interest = {
				id = acot_herculean_poi.2
				name = acot_herculean_poi.2.name
				desc = acot_herculean_poi.2.desc
				event_chain = acot_herculean_development_chain
				location = this
			}		
		}
		add_research_option = tech_precursor_colossus
    }
}

##################################################################


### COLOSSUS BEGIN
country_event = {
	id = acot_herculean_events.4
	title = "acot_herculean_events.4.name"
	desc = "acot_herculean_events.4.desc"
	picture = GFX_acot_precursor_station_plans
	show_sound = event_curious
	location = FROMFROM
	is_triggered_only = yes

	immediate = {
		remove_point_of_interest = acot_herculean_poi.2
		set_country_flag = herculean_started
		IF = {
			limit = {
				any_country = {
					is_country_type = default
					NOT = {
						is_same_value = root
					}
				}
			}
		}
		IF = {
			limit = {
				any_country = {
					is_fallen_empire = yes
					is_machine_empire = no
					NOT = {
						is_same_value = root
					}
				}
			}
		}
		IF = {
			limit = {
				any_country = {
					is_country_type = enclave
					has_country_flag = curator_enclave_country
				}
				has_country_flag = attacked_curators
			}
		}
	}

	after = {
		IF = {
			limit = {
				exists = event_target:curator_enclave_country
			}
			country_event = {
				id = acot_herculean_events.402 days = 30 random = 15
			}
		}
		IF = {
			limit = {
				OR = {
					AND = {
						any_country = {
							is_ai = yes
							has_country_flag = fallen_empire_1
						}	
						NOT = {
							has_country_flag = herculean_fe_mat_stage_one_warning
						}	
					}		
					AND = {
						any_country = {
							is_ai = yes
							has_country_flag = fallen_empire_2
						}	
						NOT = {
							has_country_flag = herculean_fe_spirit_stage_one_warning
						}	
					}
					AND = {
						any_country = {
							is_ai = yes
							has_country_flag = fallen_empire_3
						}	
						NOT = {
							has_country_flag = herculean_fe_phile_stage_one_warning
						}	
					}
					AND = {
						any_country = {
							is_ai = yes
							has_country_flag = fallen_empire_4
						}	
						NOT = {
							has_country_flag = herculean_fe_phobe_stage_one_warning
						}	
					}	
				}
			}
			random_country = {
				limit = {
					is_ai = yes
					OR = {
						has_country_flag = fallen_empire_1
						has_country_flag = fallen_empire_2
						has_country_flag = fallen_empire_3
						has_country_flag = fallen_empire_4
					}        
				}
				save_event_target_as = FallenEmpireTaskOrigin
			}
			save_event_target_as = FallenEmpireTaskTarget
#			country_event = {
#				id = acot_herculean_events.403 days = 40 random = 20
#			}
		}
	}

	option = {
		name = "acot_herculean_events.4.a"
	}
}

### COLOSSUS POWER FAILURE
country_event = {
	id = acot_herculean_events.400
	title = "acot_herculean_events.400.name"
	desc = {
		trigger = {
			NOT = {
				has_country_flag = herculean_power_failure_first_time
			}	
		}
		text = acot_herculean_events.400.desc.a
	}
	desc = {
		trigger = {
			has_country_flag = herculean_power_failure_first_time
		}
		text = acot_herculean_events.400.desc.b
	}
	picture = GFX_acot_precursor_station_plans
	show_sound = event_curious
	location = FROMFROM

	mean_time_to_happen = { days = 360 }

	trigger = {
		always = no
		NOR =  { 
			has_country_flag = herculean_power_failure 
			has_country_flag = herculean_power_failure_fixed 
		}
		any_owned_megastructure = {
			is_megastructure_type = acot_precursor_colossus_base
			is_upgrading = yes
		}
	}

	immediate = {
		set_country_flag = herculean_power_failure
		random_owned_megastructure = {
			limit = {
				is_megastructure_type = acot_precursor_colossus_base
				is_upgrading = yes
			}
			save_event_target_as = herculean_site
		}
	}

	after = {
		IF = {
			limit = {
				NOT = {
					has_country_flag = herculean_power_failure_first_time
				}
			}
			set_country_flag = herculean_power_failure_first_time
		}	
		remove_country_flag = herculean_power_failure
		set_timed_country_flag = {
			flag = herculean_power_failure
			days = 360
		}	
	}

	option = {
		name = "acot_herculean_events.400.a"
		custom_tooltip = acot_herculean_events.400.a.explain
		trigger = {
			NOT = {
				has_special_project = ACOT_HERCULEAN_POWER_FAILURE_FIX
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = alloys
				value >= 50000
			}
			resource_stockpile_compare = {
				resource = acot_sr_dark_energy
				value >= 5000
			}
			resource_stockpile_compare = {
				resource = sr_dark_matter
				value >= 5000
			}
		}
		add_resource = {
			alloys = -50000
			acot_sr_dark_energy = -5000
			sr_dark_matter = -5000
		}
	}

	option = {
		name = "acot_herculean_events.400.b"
		custom_tooltip = acot_herculean_events.400.b.explain
		event_target:herculean_site = {
			add_modifier = {
				modifier = "lower_build_speed_mult"
				days = 360
			}
		}
	}

	option = {
		name = "acot_herculean_events.400.c"
		custom_tooltip = acot_herculean_events.400.c.explain
		event_target:herculean_site = {
			set_halted = 180
		}
	}

	option = {
		name = "acot_herculean_events.400.d"
		custom_tooltip = acot_herculean_events.400.d.explain
		trigger = {
			has_country_flag = herculean_power_failure_first_time
			NOT = {
				has_special_project = ACOT_HERCULEAN_POWER_FAILURE_FIX
			}
		}		
		enable_special_project = { name = ACOT_HERCULEAN_POWER_FAILURE_FIX }
	}

	option = {
		name = "acot_herculean_events.400.e"
		custom_tooltip = acot_herculean_events.400.e.explain
		trigger = {
			has_country_flag = herculean_power_failure_first_time
			NOT = {
				has_special_project = ACOT_HERCULEAN_POWER_FAILURE_FIX
			}
		}		
		every_owned_megastructure = {
			limit = {
				OR = {
					is_megastructure_type = acot_precursor_colossus_site
					is_megastructure_type = acot_precursor_colossus_base
					is_megastructure_type = acot_precursor_colossus_stage_one
					is_megastructure_type = acot_precursor_colossus_stage_two
					is_megastructure_type = acot_precursor_colossus_final
				}
			}
			remove_megastructure = this
		}
		end_event_chain = acot_herculean_development_chain
	}
}

### COLOSSUS POWER FIXED
country_event = {
	id = acot_herculean_events.401
	title = "acot_herculean_events.401.name"
	desc = "acot_herculean_events.401.desc"
	picture = GFX_acot_precursor_station_plans
	show_sound = event_laboratory_sound
	#location = FROMFROM
	is_triggered_only = yes

	immediate = {
		set_country_flag = herculean_power_failure_fixed
	}

	option = {
		name = "acot_herculean_events.401.a"
	}
}

### CURATOR ASKS DIPLOMACY
country_event = {
	id = acot_herculean_events.402
	title = "acot_herculean_events.402.name"
	desc = {
		trigger = {
			NOT = {
				has_country_flag = attacked_curators
			}	
		}
		text = acot_herculean_events.402.desc.a
	}
	desc = {
		trigger = {
			has_country_flag = attacked_curators
		}
		text = acot_herculean_events.402.desc.b
	}

	picture_event_data = {
		portrait = event_target:curator_enclave_country
		room = enclave_curator_room
	}

	show_sound = event_curious
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"
	force_open = yes

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
		FROM = { save_event_target_as = curators }
	}

	option = {
		name = "acot_herculean_events.402.a"
		trigger = {
			NOT = {
				has_country_flag = attacked_curators
			}		
		}
		response_text = acot_herculean_events.402.a.response
		add_resource = {
			energy = 100000
			sr_dark_matter = 5000
			acot_sr_dark_energy = 5000
			physics_research = 500000
			society_research = 500000
			engineering_research = 500000
		}
		event_target:curator_enclave_country = {
			add_trust = {
				who = root
				amount = 100
			}
		}
		set_country_flag = acot_herculean_curator_assist
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = "acot_herculean_events.402.b"
		trigger = {
			NOT = {
				has_country_flag = attacked_curators
			}		
		}
		response_text = acot_herculean_events.402.b.response
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = "acot_herculean_events.402.c"
		trigger = {
			has_country_flag = attacked_curators	
		}
		response_text = acot_herculean_events.402.a.response
		event_target:curator_enclave_country = {
			add_trust = {
				who = root
				amount = 50
			}
		}
		set_country_flag = acot_herculean_curator_assist
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = "acot_herculean_events.402.d"
		trigger = {
			has_country_flag = attacked_curators	
		}
		response_text = acot_herculean_events.402.b.response
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}
}

############## FALLEN EMPIRE ORIGINATUS

country_event = {
	id = acot_herculean_events.403
	title = acot_herculean_events.403.name
	
	is_triggered_only = yes
	diplomatic = yes
	
	picture_event_data = {
		portrait = event_target:FallenEmpireTaskOrigin
		planet_background = event_target:FallenEmpireTaskOrigin
		graphical_culture = event_target:FallenEmpireTaskOrigin
		city_level = event_target:FallenEmpireTaskOrigin
		room = event_target:FallenEmpireTaskOrigin.ruler
	}
    
    desc = {
		text = acot_herculean_events.403.desc.spirit.a
		trigger = {
			event_target:FallenEmpireTaskOrigin = { 
				has_ethic = ethic_fanatic_spiritualist
			}
			NOT = {
				has_overlord = event_target:FallenEmpireTaskOrigin
				has_origin = origin_scion
			}
		}
	}
	desc = {
		text = acot_herculean_events.403.desc.spirit.b
		trigger = {
			event_target:FallenEmpireTaskOrigin = { 
				has_ethic = ethic_fanatic_spiritualist
				is_overlord_to = root
			}
			has_overlord = event_target:FallenEmpireTaskOrigin
			has_origin = origin_scion
		}
	}
    desc = {
		text = acot_herculean_events.403.desc.mat.a
		trigger = {
			event_target:FallenEmpireTaskOrigin = { 
				has_ethic = ethic_fanatic_materialist
			}
			NOT = {
				has_overlord = event_target:FallenEmpireTaskOrigin
				has_origin = origin_scion
			}
		}
	}
	desc = {
		text = acot_herculean_events.403.desc.mat.b
		trigger = {
			event_target:FallenEmpireTaskOrigin = { 
				has_ethic = ethic_fanatic_materialist
				is_overlord_to = root
			}
			has_overlord = event_target:FallenEmpireTaskOrigin
			has_origin = origin_scion
		}
	}
    desc = {
		text = acot_herculean_events.403.desc.phile.a
		trigger = {
			event_target:FallenEmpireTaskOrigin = { 
				has_ethic = ethic_fanatic_xenophile
			}
		}
	}
	desc = {
		text = acot_herculean_events.403.desc.phobe.a
		trigger = {
			event_target:FallenEmpireTaskOrigin = { 
				has_ethic = ethic_fanatic_xenophobe
			}
		}
    }

	immediate = {
		IF = {
			limit = {
				event_target:FallenEmpireTaskOrigin = { 
					has_ethic = ethic_fanatic_spiritualist
				}				
			}
			set_country_flag = herculean_fe_spirit_stage_one_warning
		}
		IF = {
			limit = {
				event_target:FallenEmpireTaskOrigin = { 
					has_ethic = ethic_fanatic_materialist
				}				
			}
			set_country_flag = herculean_fe_mat_stage_one_warning
		}
		IF = {
			limit = {
				event_target:FallenEmpireTaskOrigin = { 
					has_ethic = ethic_fanatic_xenophobe
				}				
			}
			set_country_flag = herculean_fe_phobe_stage_one_warning
		}
		IF = {
			limit = {
				event_target:FallenEmpireTaskOrigin = { 
					has_ethic = ethic_fanatic_xenophile
				}				
			}
			set_country_flag = herculean_fe_phile_stage_one_warning
		}
	}

    option = {
        name = acot_herculean_events.403.a
        response_text = acot_herculean_events.403.a.response
        save_event_target_as = FallenEmpireTaskTarget
        event_target:FallenEmpireTaskOrigin = { 
            add_opinion_modifier = { 
                who = root modifier = opinion_majorly_failed_fallen_empire_task
             }  
        }	
        ai_chance = {
            factor = 2
        }
    }

    option = {
        name = acot_herculean_events.403.b
        response_text = acot_herculean_events.403.b.response
		save_event_target_as = FallenEmpireTaskTarget
        event_target:FallenEmpireTaskOrigin = { 
            add_opinion_modifier = { 
                who = root modifier = opinion_refused_fallen_empire_demand
             }  
        }	
        ai_chance = {
            factor = 2
        }
    }

    option = {
        name = acot_herculean_events.403.c
        response_text = acot_herculean_events.403.c.response
        hidden_effect = {
			every_owned_megastructure = {
				limit = {
					OR = {
						is_megastructure_type = acot_precursor_colossus_site
						is_megastructure_type = acot_precursor_colossus_base
						is_megastructure_type = acot_precursor_colossus_stage_one
						is_megastructure_type = acot_precursor_colossus_stage_two
						is_megastructure_type = acot_precursor_colossus_final
					}
				}
				remove_megastructure = this
			}
			end_event_chain = acot_herculean_development_chain          
        }
        ai_chance = {
            factor = 1
        }
    }

	after = {
		hidden_effect = {
			IF = {
				limit = {
					OR = {
						AND = {
							any_country = {
								is_ai = yes
								has_country_flag = fallen_empire_1
							}	
							NOT = {
								has_country_flag = herculean_fe_mat_stage_one_warning
							}	
						}		
						AND = {
							any_country = {
								is_ai = yes
								has_country_flag = fallen_empire_2
							}	
							NOT = {
								has_country_flag = herculean_fe_spirit_stage_one_warning
							}	
						}
						AND = {
							any_country = {
								is_ai = yes
								has_country_flag = fallen_empire_3
							}	
							NOT = {
								has_country_flag = herculean_fe_phile_stage_one_warning
							}	
						}
						AND = {
							any_country = {
								is_ai = yes
								has_country_flag = fallen_empire_4
							}	
							NOT = {
								has_country_flag = herculean_fe_phobe_stage_one_warning
							}	
						}	
					}
				}
				random_country = {
					limit = {
						is_ai = yes
						OR = {
							has_country_flag = fallen_empire_1
							has_country_flag = fallen_empire_2
							has_country_flag = fallen_empire_3
							has_country_flag = fallen_empire_4
						}        
					}
					save_event_target_as = FallenEmpireTaskOrigin
				}
				save_event_target_as = FallenEmpireTaskTarget
				country_event = {
					id = acot_herculean_events.403 days = 40 random = 20
				}
			}
		}
	}
}

############################ STAGE ONE ############################

### BASE ####
country_event = {
	id = acot_herculean_events.5
	title = "acot_herculean_events.5.name"
	desc = "acot_herculean_events.5.desc"
	picture = GFX_acot_precursor_colossus_base
	show_sound = event_curious
	location = FROMFROM

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
		IF = {
			limit = {
				any_country = {
					is_country_type = default
					NOT = {
						is_same_value = root
					}
				}
			}
		}
		IF = {
			limit = {
				any_country = {
					is_fallen_empire = yes
					is_machine_empire = no
					NOT = {
						is_same_value = root
					}
				}
			}
		}
		IF = {
			limit = {
				any_country = {
					is_country_type = enclave
					has_country_flag = curator_enclave_country
				}
				has_country_flag = acot_herculean_curator_assist
			}
			country_event = {
				id = acot_herculean_events.502 days = 30 random = 15
			}
		}
	}

	option = {
		name = "acot_herculean_events.5.a"
	}

	option = {
		name = "acot_herculean_events.5.b"
	}
}

### CURATOR ASKS DIPLOMACY
country_event = {
	id = acot_herculean_events.502
	title = "acot_herculean_events.502.name"
	desc = acot_herculean_events.502.desc

	picture_event_data = {
		portrait = event_target:curator_enclave_country
		room = enclave_curator_room
	}

	show_sound = event_curious
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"
	force_open = yes

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
		FROM = { save_event_target_as = curators }
	}

	option = {
		name = "acot_herculean_events.502.a"
		trigger = {
			NOT = {
				has_country_flag = attacked_curators
			}		
		}
		response_text = acot_herculean_events.502.a.response
		event_target:curator_enclave_country = {
			add_trust = {
				who = root
				amount = 100
			}
		}
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = "acot_herculean_events.502.b"
		trigger = {
			NOT = {
				has_country_flag = attacked_curators
			}		
		}
		response_text = acot_herculean_events.502.b.response
		hidden_effect = {
			remove_country_flag = acot_herculean_curator_assist
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = "acot_herculean_events.502.c"
		trigger = {
			has_country_flag = attacked_curators	
		}
		response_text = acot_herculean_events.502.c.response
		hidden_effect = {
			remove_country_flag = acot_herculean_curator_assist
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

}

############################ STAGE TWO ############################

country_event = {
	id = acot_herculean_events.6
	title = "acot_herculean_events.6.name"
	desc = "acot_herculean_events.6.desc"
	picture = GFX_acot_precursor_colossus_stage_one
	show_sound = event_curious
	location = FROMFROM

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
		IF = {
			limit = {
				any_country = {
					is_country_type = default
					NOT = {
						is_same_value = root
					}
				}
			}
		}
		IF = {
			limit = {
				any_country = {
					is_fallen_empire = yes
					is_machine_empire = no
					NOT = {
						is_same_value = root
					}
				}
			}
		}
		IF = {
			limit = {
				any_country = {
					is_country_type = enclave
					has_country_flag = curator_enclave_country
				}
				has_country_flag = attacked_curators
			}
		}
	}

	option = {
		name = "acot_herculean_events.6.a"
	}

	option = {
		name = "acot_herculean_events.6.b"
	}
}

############################ STAGE THREE ############################


country_event = {
	id = acot_herculean_events.7
	title = "acot_herculean_events.7.name"
	desc = "acot_herculean_events.7.desc"
	picture = GFX_acot_precursor_colossus_stage_two
	show_sound = event_curious
	location = FROMFROM

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
		IF = {
			limit = {
				any_country = {
					is_country_type = default
					NOT = {
						is_same_value = root
					}
				}
			}
		}
		IF = {
			limit = {
				any_country = {
					is_fallen_empire = yes
					is_machine_empire = no
					NOT = {
						is_same_value = root
					}
				}
			}
		}
		IF = {
			limit = {
				any_country = {
					is_country_type = enclave
					has_country_flag = curator_enclave_country
				}
				has_country_flag = attacked_curators
			}
		}
	}

	option = {
		name = "acot_herculean_events.7.a"
	}

	option = {
		name = "acot_herculean_events.7.b"
	}
}

############################ COMPLETION ############################

country_event = {
	id = acot_herculean_events.8
	title = "acot_herculean_events.8.name"
	desc = "acot_herculean_events.8.desc"
	picture = GFX_acot_precursor_colossus_stage_two
	show_sound = event_herculean_start
	location = FROMFROM

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
		set_country_flag = herculean_built
		if = {
			limit = { 
				has_event_chain = acot_herculean_development_chain
			}
			end_event_chain = acot_herculean_development_chain
		}
		IF = {
			limit = {
				any_country = {
					is_country_type = default
					NOT = {
						is_same_value = root
					}
				}
			}
		}
		IF = {
			limit = {
				any_country = {
					is_fallen_empire = yes
					is_machine_empire = no
					NOT = {
						is_same_value = root
					}
				}
			}
		}
		IF = {
			limit = {
				any_country = {
					is_country_type = enclave
					has_country_flag = curator_enclave_country
				}
				has_country_flag = attacked_curators
			}
		}
	}

	option = {
		name = "acot_herculean_events.8.a"
	}

	option = {
		name = "acot_herculean_events.8.b"
	}
}

#HERCULEAN FINAL
country_event = {
	id = acot_herculean_events.9
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		FROM = { 
			is_megastructure_type = acot_precursor_colossus_final
		}
	}

	immediate = {
		FROM = {
			create_fleet = {
				settings = {
					 spawn_debris = no 
					 is_boss = yes
				}
				effect = {
					set_owner = root
					while = {
						count = 1
						create_ship = {
							random_existing_design = precursor_colossus
							graphical_culture = root
							effect = {
								set_disable_at_health = 0.02
							}
						}
					}
					set_location = {
						target = prev
						distance = 45
						angle = random
					}
				}
			}
			remove_megastructure = this
		}
	}
}	

#HERCULEAN NEW TECH
country_event = {
	id = acot_herculean_events.100
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		last_increased_tech = tech_acot_precursor_herculean_regain
	}

	immediate = {
		remove_country_flag = acot_herculean_research_required
	}
}	

#################################################

#HERCULEAN NEW TECH
planet_event = {
	id = acot_herculean_events.5000
	hide_window = yes

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
		add_threat = { who = from.owner amount = 50 }
		solar_system = { save_event_target_as = destroyed_system }
		from.owner = {
			save_event_target_as = herculean_owner
		}
		solar_system = {
			every_ship_in_system = {
				limit = {
					fleet = {
						NOR = {
							is_same_value = from
							owner = {
								is_progenitor_empires = yes
							}
						}
						solar_system = {
							is_same_value = event_target:destroyed_system
						}
					}
				}
				reduce_hp = 100000
			}	
			random_system_planet = {
				limit = { has_modifier = holy_planet }
				planet_event = { id = planet_destruction.605 }
			}
			fire_on_action = { on_action = on_destroy_star_system }
			set_timed_star_flag = {
				flag = acot_star_cascade_cooldown
				days = 1800
			}
			set_star_class = sc_acot_void_star
			every_system_ambient_object = {
				limit = {
					# Preserve Unbidden crisis effects
					NOR = {
						has_ambient_object_flag = extradimensional_system_effect
						has_ambient_object_flag = extradimensional_system_effect_2
					}
				}
				destroy_ambient_object = this
			}
			star = {
				create_ambient_object = {
					type = "acot_amerigo_void_nebula"
					location = this
					duration = 1800
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 0
						angle = random
					}
				}			
			}
			every_system_planet = {
				limit = { is_star = yes }
				create_ambient_object = {
					type = "star_explosion"
					play_animation_once = yes
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 0
						angle = random
					}
				}
				change_pc = pc_acot_void_star
			}
			# Handle Contingency Machine Worlds
			every_system_planet = {
				limit = {
					is_planet_class = pc_ai
					NOT = { has_planet_flag = machine_lair }
				}
				destroy_machine_world = yes
			}
			random_system_planet = {
				limit = {
					is_star = yes
				}
				planet_event = {
					id = acot_herculean_events.5002 days = 1800 random = 300
				}
			}
			random_system_planet = {
				limit = {
					is_planet_class = pc_ai
					has_planet_flag = machine_lair
				}
				from.owner = { save_event_target_as = final_machine_world_destroyer }
				stop_crisis_sound = yes
				planet_event = { id = crisis.2046 }
			}
			every_system_planet = {
				limit = {
					is_asteroid = yes
				}
				remove_planet = yes
			}
			every_system_planet = {
				limit = {
					is_star = no
					is_asteroid = no
					NOR = {
						is_planet_class = pc_shattered
						is_planet_class = pc_shattered_2
						is_planet_class = pc_shielded
						is_planet_class = pc_dark_fractured
						is_planet_class = pc_dark_fractured_ae
						is_planet_class = pc_dark_fractured_unstable
						is_planet_class = pc_dark_fractured_ae_unstable
						is_planet_class = pc_acot_enigmopolis
						is_planet_class = pc_acot_pmc_vault
						is_planet_class = pc_acot_pmc_vault_unshielded
					}
				}
				#Dismantle observation post
				if = {
					limit = {
						has_observation_outpost = yes
					}
					observation_outpost_owner = {
						country_event = { id = planet_destruction.1000 days = 1 }
					}
				}		
				if = {
					limit = {
						exists = orbital_defence
					}
					destroy_fleet = orbital_defence
				}					
				if = {
					limit = { is_colony = yes }
					remove_all_buildings = yes
					destroy_colony = yes
					if = {
						limit = { is_planet_class = pc_habitat }
						spawn_habitat_cracker_effect = yes
						change_pc = pc_acot_void_hole
						set_planet_size = 5
					}
					else_if = {
						limit = { is_ringworld = yes }
						spawn_ringworld_cracker_effect = yes
						change_pc = pc_acot_void_hole
						set_planet_size = 10
					}
					else = {
						random_list = {
							20 = {
								modifier = {
									factor = 0
									planet_size <= 25
								}
								change_pc = pc_acot_void_hole
							}
							40 = {
								change_pc = pc_dark_fractured_unstable
							}
							30 = {
								change_pc = pc_dark_fractured_ae
							}
							10 = {
								change_pc = pc_dark_fractured_ae_unstable
							}
						}
					}
				}
				else_if = {
					limit = { 
						OR = {
							is_planet_class = pc_ringworld_tech
							is_planet_class = pc_ringworld_tech_damaged
							is_planet_class = pc_ringworld_seam
							is_planet_class = pc_ringworld_seam_damaged
							is_planet_class = pc_ringworld_habitable_damaged
						} 
					}
					spawn_ringworld_cracker_effect = yes
					change_pc = pc_acot_void_hole
					set_planet_size = 5
				}
				else = {
					random_list = {
						20 = {
							modifier = {
								factor = 0
								planet_size <= 25
							}
							change_pc = pc_acot_void_hole
						}
						40 = {
							change_pc = pc_dark_fractured_unstable
						}
						30 = {
							change_pc = pc_dark_fractured_ae
						}
						10 = {
							change_pc = pc_dark_fractured_ae_unstable
						}
					}
				}
			}
		}
		solar_system = {
			every_ship_in_system = {
				limit = {
					fleet = {
						NOR = {
							is_same_value = from
							owner = {
								is_progenitor_empires = yes
							}
						}
						solar_system = {
							is_same_value = event_target:destroyed_system
						}
					}
				}
				IF = {
					limit = {
						acot_ship_is_immune_to_lethal_attack = yes
					}
					reduce_hp = 1000000
				}
				else = {
					destroy_ship = this
				}
			}	
		}
		solar_system = {
			every_neighbor_system = {
				limit = {
					exists = owner
					any_system_planet = {
						is_star = yes
					}
					owner = {
						OR = {
							is_at_war_with = event_target:herculean_owner
							is_hostile_to = event_target:herculean_owner
						}
					}
					NOR = {
						has_star_flag = acot_star_cascade_cooldown
						has_star_flag = acot_star_cascade_primed
						has_star_flag = outergate
						any_system_megastructure = {
							is_megastructure_type = sofe_outer_gate
						}
					}
				}
				set_star_flag = acot_star_cascade_primed
				random_system_planet = {
					limit = { 
						is_star = yes 
					}
					planet_event = {
						id = acot_herculean_events.5001 days = 120 random = 60
					}
				}
			}
		}
	}
}

#HERCULEAN NEW TECH
planet_event = {
	id = acot_herculean_events.5001
	hide_window = yes

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
		solar_system = {
			remove_star_flag = acot_star_cascade_primed	
		}
		add_threat = { who = event_target:herculean_owner amount = 50 }
		solar_system = { save_event_target_as = destroyed_system }
		solar_system = {
			random_system_planet = {
				limit = { has_modifier = holy_planet }
				planet_event = { id = planet_destruction.605 }
			}
			fire_on_action = { on_action = on_destroy_star_system }
			set_timed_star_flag = {
				flag = acot_star_cascade_cooldown
				days = 1800
			}
			set_star_class = sc_acot_void_star
			every_system_ambient_object = {
				limit = {
					# Preserve Unbidden crisis effects
					NOR = {
						has_ambient_object_flag = extradimensional_system_effect
						has_ambient_object_flag = extradimensional_system_effect_2
					}
				}
				destroy_ambient_object = this
			}
			star = {
				create_ambient_object = {
					type = "acot_amerigo_void_nebula"
					location = this
					duration = 1800
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 0
						angle = random
					}
				}			
			}
			every_system_planet = {
				limit = { is_star = yes }
				create_ambient_object = {
					type = "star_explosion"
					play_animation_once = yes
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 0
						angle = random
					}
				}
				change_pc = pc_acot_void_star
			}
			random_system_planet = {
				limit = {
					is_star = yes
				}
				planet_event = {
					id = acot_herculean_events.5002 days = 1800 random = 300
				}
			}
			# Handle Contingency Machine Worlds
			every_system_planet = {
				limit = {
					is_planet_class = pc_ai
					NOT = { has_planet_flag = machine_lair }
				}
				destroy_machine_world = yes
			}
			random_system_planet = {
				limit = {
					is_planet_class = pc_ai
					has_planet_flag = machine_lair
				}
				from.owner = { save_event_target_as = final_machine_world_destroyer }
				stop_crisis_sound = yes
				planet_event = { id = crisis.2046 }
			}
			every_system_planet = {
				limit = {
					is_asteroid = yes
				}
				remove_planet = yes
			}
			every_system_planet = {
				limit = {
					is_star = no
					is_asteroid = no
					NOR = {
						is_planet_class = pc_shattered
						is_planet_class = pc_shattered_2
						is_planet_class = pc_shielded
						acot_planet_immune_to_destruction = yes
					}
				}
				#Dismantle observation post
				if = {
					limit = {
						has_observation_outpost = yes
					}
					observation_outpost_owner = {
						country_event = { id = planet_destruction.1000 days = 1 }
					}
				}		
				if = {
					limit = {
						exists = orbital_defence
					}
					destroy_fleet = orbital_defence
				}	
				if = {
					limit = { is_colony = yes }
					remove_all_buildings = yes
					destroy_colony = yes
					if = {
						limit = { is_planet_class = pc_habitat }
						spawn_habitat_cracker_effect = yes
						change_pc = pc_acot_void_hole
						set_planet_size = 5
					}
					else_if = {
						limit = { is_ringworld = yes }
						spawn_ringworld_cracker_effect = yes
						change_pc = pc_acot_void_hole
						set_planet_size = 10
					}
					else = {
						random_list = {
							20 = {
								modifier = {
									factor = 0
									planet_size <= 25
								}
								change_pc = pc_acot_void_hole
							}
							40 = {
								change_pc = pc_dark_fractured_unstable
							}
							30 = {
								change_pc = pc_dark_fractured_ae
							}
							10 = {
								change_pc = pc_dark_fractured_ae_unstable
							}
						}
					}
				}
				else_if = {
					limit = { 
						OR = {
							is_planet_class = pc_ringworld_tech
							is_planet_class = pc_ringworld_tech_damaged
							is_planet_class = pc_ringworld_seam
							is_planet_class = pc_ringworld_seam_damaged
							is_planet_class = pc_ringworld_habitable_damaged
						} 
					}
					spawn_ringworld_cracker_effect = yes
					change_pc = pc_acot_void_hole
					set_planet_size = 5
				}
				else = {
					random_list = {
						20 = {
							modifier = {
								factor = 0
								planet_size <= 25
							}
							change_pc = pc_acot_void_hole
						}
						40 = {
							change_pc = pc_dark_fractured_unstable
						}
						30 = {
							change_pc = pc_dark_fractured_ae
						}
						10 = {
							change_pc = pc_dark_fractured_ae_unstable
						}
					}
				}
			}
		}
		solar_system = {
			every_ship_in_system = {
				limit = {
					fleet = {
						NOR = {
							is_same_value = from
							owner = {
								is_progenitor_empires = yes
							}
						}
						solar_system = {
							is_same_value = event_target:destroyed_system
						}
					}
				}
				IF = {
					limit = {
						acot_ship_is_immune_to_lethal_attack = yes
					}
					reduce_hp = 1000000
				}
				else = {
					destroy_ship = this
				}
			}	
		}
		solar_system = {
			every_neighbor_system = {
				limit = {
					exists = owner
					any_system_planet = {
						is_star = yes
					}
					owner = {
						OR = {
							is_at_war_with = event_target:herculean_owner
							is_hostile_to = event_target:herculean_owner
						}
					}
					NOR = {
						has_star_flag = acot_star_cascade_cooldown
						has_star_flag = acot_star_cascade_primed
						has_star_flag = outergate
						any_system_megastructure = {
							is_megastructure_type = sofe_outer_gate
						}
						solar_system = {
							systems_blokkats_wont_stripmine = yes
						}
					}
				}
				set_star_flag = acot_star_cascade_primed
				random_system_planet = {
					limit = { 
						is_star = yes 
					}
					planet_event = {
						id = acot_herculean_events.5001 days = 120 random = 60
					}
				}
			}
		}
	}
}

# SYSTEM BECOMES NORMAL AGAIN
planet_event = {
	id = acot_herculean_events.5002
	hide_window = yes

	is_triggered_only = yes
	
	trigger = {
	}
	
	immediate = {
		solar_system = {
			set_star_class = sc_black_hole
			every_system_planet = {
				limit = { is_star = yes }
				change_pc = pc_acot_void_hole
			}
		}
	}
}

planet_event = {
	id = acot_herculean_events.5100
	hide_window = yes

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
		add_threat = { who = from.owner amount = 50 }
		solar_system = { save_event_target_as = destroyed_system }
		from.owner = {
			save_event_target_as = herculean_owner
		}
		solar_system = {
			every_ship_in_system = {
				limit = {
					fleet = {
						NOR = {
							is_same_value = from
							owner = {
								is_progenitor_empires = yes
							}
						}
						solar_system = {
							is_same_value = event_target:destroyed_system
						}
					}
				}
				reduce_hp = 100000
			}	
			random_system_planet = {
				limit = { has_modifier = holy_planet }
				planet_event = { id = planet_destruction.605 }
			}
			fire_on_action = { on_action = on_destroy_star_system }
			set_timed_star_flag = {
				flag = acot_star_cascade_cooldown
				days = 1800
			}
			set_star_class = sc_acot_void_star
			every_system_ambient_object = {
				limit = {
					# Preserve Unbidden crisis effects
					NOR = {
						has_ambient_object_flag = extradimensional_system_effect
						has_ambient_object_flag = extradimensional_system_effect_2
					}
				}
				destroy_ambient_object = this
			}
			star = {
				create_ambient_object = {
					type = "acot_amerigo_void_nebula"
					location = this
					duration = 1800
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 0
						angle = random
					}
				}			
			}
			every_system_planet = {
				limit = { is_star = yes }
				create_ambient_object = {
					type = "star_explosion"
					play_animation_once = yes
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 0
						angle = random
					}
				}
				change_pc = pc_acot_void_star
			}
			# Handle Contingency Machine Worlds
			every_system_planet = {
				limit = {
					is_planet_class = pc_ai
					NOT = { has_planet_flag = machine_lair }
				}
				destroy_machine_world = yes
			}
			random_system_planet = {
				limit = {
					is_star = yes
				}
				planet_event = {
					id = acot_herculean_events.5002 days = 1800 random = 300
				}
			}
			random_system_planet = {
				limit = {
					is_planet_class = pc_ai
					has_planet_flag = machine_lair
				}
				from.owner = { save_event_target_as = final_machine_world_destroyer }
				stop_crisis_sound = yes
				planet_event = { id = crisis.2046 }
			}
			every_system_planet = {
				limit = {
					is_asteroid = yes
				}
				remove_planet = yes
			}
			every_system_planet = {
				limit = {
					is_star = no
					is_asteroid = no
					NOR = {
						is_planet_class = pc_shattered
						is_planet_class = pc_shattered_2
						is_planet_class = pc_shielded
						is_planet_class = pc_dark_fractured
						is_planet_class = pc_dark_fractured_ae
						is_planet_class = pc_dark_fractured_unstable
						is_planet_class = pc_dark_fractured_ae_unstable
						is_planet_class = pc_acot_enigmopolis
						is_planet_class = pc_acot_pmc_vault
						is_planet_class = pc_acot_pmc_vault_unshielded
					}
				}
				#Dismantle observation post
				if = {
					limit = {
						has_observation_outpost = yes
					}
					observation_outpost_owner = {
						country_event = { id = planet_destruction.1000 days = 1 }
					}
				}		
				if = {
					limit = {
						exists = orbital_defence
					}
					destroy_fleet = orbital_defence
				}					
				if = {
					limit = { is_colony = yes }
					remove_all_buildings = yes
					destroy_colony = yes
					if = {
						limit = { is_planet_class = pc_habitat }
						spawn_habitat_cracker_effect = yes
						change_pc = pc_acot_void_hole
						set_planet_size = 5
					}
					else_if = {
						limit = { is_ringworld = yes }
						spawn_ringworld_cracker_effect = yes
						change_pc = pc_acot_void_hole
						set_planet_size = 10
					}
					else = {
						random_list = {
							20 = {
								modifier = {
									factor = 0
									planet_size <= 25
								}
								change_pc = pc_acot_void_hole
							}
							40 = {
								change_pc = pc_dark_fractured_unstable
							}
							30 = {
								change_pc = pc_dark_fractured_ae
							}
							10 = {
								change_pc = pc_dark_fractured_ae_unstable
							}
						}
					}
				}
				else_if = {
					limit = { 
						OR = {
							is_planet_class = pc_ringworld_tech
							is_planet_class = pc_ringworld_tech_damaged
							is_planet_class = pc_ringworld_seam
							is_planet_class = pc_ringworld_seam_damaged
							is_planet_class = pc_ringworld_habitable_damaged
						} 
					}
					spawn_ringworld_cracker_effect = yes
					change_pc = pc_acot_void_hole
					set_planet_size = 5
				}
				else = {
					random_list = {
						20 = {
							modifier = {
								factor = 0
								planet_size <= 25
							}
							change_pc = pc_acot_void_hole
						}
						40 = {
							change_pc = pc_dark_fractured_unstable
						}
						30 = {
							change_pc = pc_dark_fractured_ae
						}
						10 = {
							change_pc = pc_dark_fractured_ae_unstable
						}
					}
				}
			}
		}
		solar_system = {
			every_ship_in_system = {
				limit = {
					fleet = {
						NOR = {
							is_same_value = from
							owner = {
								is_progenitor_empires = yes
							}
						}
						solar_system = {
							is_same_value = event_target:destroyed_system
						}
					}
				}
				IF = {
					limit = {
						acot_ship_is_immune_to_lethal_attack = yes
					}
					reduce_hp = 1000000
				}
				else = {
					destroy_ship = this
				}
			}	
		}
	}
}

#HERCULEAN SIGMA 
planet_event = {
	id = acot_herculean_events.5200
	hide_window = yes

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
		add_threat = { who = from.owner amount = 50 }
		solar_system = { save_event_target_as = destroyed_system }
		from.owner = {
			save_event_target_as = herculean_owner
		}
		solar_system = {
			every_ship_in_system = {
				limit = {
					fleet = {
						NOR = {
							is_same_value = from
							owner = {
								is_progenitor_empires = yes
							}
						}
						solar_system = {
							is_same_value = event_target:destroyed_system
						}
					}
				}
				reduce_hp = 100000
			}	
			random_system_planet = {
				limit = { has_modifier = holy_planet }
				planet_event = { id = planet_destruction.605 }
			}
			fire_on_action = { on_action = on_destroy_star_system }
			set_timed_star_flag = {
				flag = acot_star_cascade_cooldown
				days = 1800
			}
			set_star_class = sc_acot_void_star
			every_system_ambient_object = {
				limit = {
					# Preserve Unbidden crisis effects
					NOR = {
						has_ambient_object_flag = extradimensional_system_effect
						has_ambient_object_flag = extradimensional_system_effect_2
					}
				}
				destroy_ambient_object = this
			}
			star = {
				create_ambient_object = {
					type = "acot_amerigo_void_nebula"
					location = this
					duration = 1800
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 0
						angle = random
					}
				}			
			}
			every_system_planet = {
				limit = { is_star = yes }
				create_ambient_object = {
					type = "star_explosion"
					play_animation_once = yes
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 0
						angle = random
					}
				}
				change_pc = pc_acot_void_star
			}
			# Handle Contingency Machine Worlds
			every_system_planet = {
				limit = {
					is_planet_class = pc_ai
					NOT = { has_planet_flag = machine_lair }
				}
				destroy_machine_world = yes
			}
			random_system_planet = {
				limit = {
					is_star = yes
				}
				planet_event = {
					id = acot_herculean_events.5002 days = 1800 random = 300
				}
			}
			random_system_planet = {
				limit = {
					is_planet_class = pc_ai
					has_planet_flag = machine_lair
				}
				from.owner = { save_event_target_as = final_machine_world_destroyer }
				stop_crisis_sound = yes
				planet_event = { id = crisis.2046 }
			}
			every_system_planet = {
				limit = {
					is_asteroid = yes
				}
				remove_planet = yes
			}
			every_system_planet = {
				limit = {
					is_star = no
					is_asteroid = no
					NOR = {
						is_planet_class = pc_shattered
						is_planet_class = pc_shattered_2
						is_planet_class = pc_shielded
						is_planet_class = pc_dark_fractured
						is_planet_class = pc_dark_fractured_ae
						is_planet_class = pc_dark_fractured_unstable
						is_planet_class = pc_dark_fractured_ae_unstable
						is_planet_class = pc_acot_enigmopolis
						is_planet_class = pc_acot_pmc_vault
						is_planet_class = pc_acot_pmc_vault_unshielded
					}
				}
				#Dismantle observation post
				if = {
					limit = {
						has_observation_outpost = yes
					}
					observation_outpost_owner = {
						country_event = { id = planet_destruction.1000 days = 1 }
					}
				}		
				if = {
					limit = {
						exists = orbital_defence
					}
					destroy_fleet = orbital_defence
				}					
				if = {
					limit = { is_colony = yes }
					remove_all_buildings = yes
					destroy_colony = yes
					if = {
						limit = { is_planet_class = pc_habitat }
						spawn_habitat_cracker_effect = yes
						change_pc = pc_acot_void_hole
						set_planet_size = 5
					}
					else_if = {
						limit = { is_ringworld = yes }
						spawn_ringworld_cracker_effect = yes
						change_pc = pc_acot_void_hole
						set_planet_size = 10
					}
					else = {
						random_list = {
							20 = {
								modifier = {
									factor = 0
									planet_size <= 25
								}
								change_pc = pc_acot_void_hole
							}
							40 = {
								change_pc = pc_dark_fractured_unstable
							}
							30 = {
								change_pc = pc_dark_fractured_ae
							}
							10 = {
								change_pc = pc_dark_fractured_ae_unstable
							}
						}
					}
				}
				else_if = {
					limit = { 
						OR = {
							is_planet_class = pc_ringworld_tech
							is_planet_class = pc_ringworld_tech_damaged
							is_planet_class = pc_ringworld_seam
							is_planet_class = pc_ringworld_seam_damaged
							is_planet_class = pc_ringworld_habitable_damaged
						} 
					}
					spawn_ringworld_cracker_effect = yes
					change_pc = pc_acot_void_hole
					set_planet_size = 5
				}
				else = {
					random_list = {
						20 = {
							modifier = {
								factor = 0
								planet_size <= 25
							}
							change_pc = pc_acot_void_hole
						}
						40 = {
							change_pc = pc_dark_fractured_unstable
						}
						30 = {
							change_pc = pc_dark_fractured_ae
						}
						10 = {
							change_pc = pc_dark_fractured_ae_unstable
						}
					}
				}
			}
		}
		solar_system = {
			every_ship_in_system = {
				limit = {
					fleet = {
						NOR = {
							is_same_value = from
							owner = {
								is_progenitor_empires = yes
							}
						}
						solar_system = {
							is_same_value = event_target:destroyed_system
						}
					}
				}
				IF = {
					limit = {
						acot_ship_is_immune_to_lethal_attack = yes
					}
					reduce_hp = 1000000
				}
				else = {
					destroy_ship = this
				}
			}	
		}
		solar_system = {
			every_neighbor_system = {
				limit = {
					exists = owner
					any_system_planet = {
						is_star = yes
					}
					owner = {
						OR = {
							is_at_war_with = event_target:herculean_owner
							is_hostile_to = event_target:herculean_owner
						}
					}
					NOR = {
						has_star_flag = acot_star_cascade_cooldown
						has_star_flag = acot_star_cascade_primed
						has_star_flag = outergate
						any_system_megastructure = {
							is_megastructure_type = sofe_outer_gate
						}
					}
				}
				set_star_flag = acot_star_cascade_primed
				random_system_planet = {
					limit = { 
						is_star = yes 
					}
					planet_event = {
						id = acot_herculean_events.5201 days = 120 random = 60
					}
				}
			}
		}
		random_system = {
			limit = {
				exists = owner
				any_system_planet = {
					is_star = yes
				}
				owner = {
					OR = {
						is_at_war_with = event_target:herculean_owner
						is_hostile_to = event_target:herculean_owner
					}
				}
				NOR = {
					has_star_flag = acot_star_cascade_cooldown
					has_star_flag = acot_star_cascade_primed
					has_star_flag = outergate
					any_system_megastructure = {
						is_megastructure_type = sofe_outer_gate
					}
				}
			}
			set_star_flag = acot_star_cascade_primed
			random_system_planet = {
				limit = { 
					is_star = yes 
				}
				planet_event = {
					id = acot_herculean_events.5201 days = 120 random = 60
				}
			}
		}
	}
}

#HERCULEAN NEW TECH
planet_event = {
	id = acot_herculean_events.5201
	hide_window = yes

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
		solar_system = {
			remove_star_flag = acot_star_cascade_primed	
		}
		add_threat = { who = event_target:herculean_owner amount = 50 }
		solar_system = { save_event_target_as = destroyed_system }
		solar_system = {
			random_system_planet = {
				limit = { has_modifier = holy_planet }
				planet_event = { id = planet_destruction.605 }
			}
			fire_on_action = { on_action = on_destroy_star_system }
			set_timed_star_flag = {
				flag = acot_star_cascade_cooldown
				days = 1800
			}
			set_star_class = sc_acot_void_star
			every_system_ambient_object = {
				limit = {
					# Preserve Unbidden crisis effects
					NOR = {
						has_ambient_object_flag = extradimensional_system_effect
						has_ambient_object_flag = extradimensional_system_effect_2
					}
				}
				destroy_ambient_object = this
			}
			star = {
				create_ambient_object = {
					type = "acot_amerigo_void_nebula"
					location = this
					duration = 1800
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 0
						angle = random
					}
				}			
			}
			every_system_planet = {
				limit = { is_star = yes }
				create_ambient_object = {
					type = "star_explosion"
					play_animation_once = yes
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 0
						angle = random
					}
				}
				change_pc = pc_acot_void_star
			}
			random_system_planet = {
				limit = {
					is_star = yes
				}
				planet_event = {
					id = acot_herculean_events.5002 days = 1800 random = 300
				}
			}
			# Handle Contingency Machine Worlds
			every_system_planet = {
				limit = {
					is_planet_class = pc_ai
					NOT = { has_planet_flag = machine_lair }
				}
				destroy_machine_world = yes
			}
			random_system_planet = {
				limit = {
					is_planet_class = pc_ai
					has_planet_flag = machine_lair
				}
				from.owner = { save_event_target_as = final_machine_world_destroyer }
				stop_crisis_sound = yes
				planet_event = { id = crisis.2046 }
			}
			every_system_planet = {
				limit = {
					is_asteroid = yes
				}
				remove_planet = yes
			}
			every_system_planet = {
				limit = {
					is_star = no
					is_asteroid = no
					NOR = {
						is_planet_class = pc_shattered
						is_planet_class = pc_shattered_2
						is_planet_class = pc_shielded
						acot_planet_immune_to_destruction = yes
					}
				}
				#Dismantle observation post
				if = {
					limit = {
						has_observation_outpost = yes
					}
					observation_outpost_owner = {
						country_event = { id = planet_destruction.1000 days = 1 }
					}
				}		
				if = {
					limit = {
						exists = orbital_defence
					}
					destroy_fleet = orbital_defence
				}	
				if = {
					limit = { is_colony = yes }
					remove_all_buildings = yes
					destroy_colony = yes
					if = {
						limit = { is_planet_class = pc_habitat }
						spawn_habitat_cracker_effect = yes
						change_pc = pc_acot_void_hole
						set_planet_size = 5
					}
					else_if = {
						limit = { is_ringworld = yes }
						spawn_ringworld_cracker_effect = yes
						change_pc = pc_acot_void_hole
						set_planet_size = 10
					}
					else = {
						random_list = {
							20 = {
								modifier = {
									factor = 0
									planet_size <= 25
								}
								change_pc = pc_acot_void_hole
							}
							40 = {
								change_pc = pc_dark_fractured_unstable
							}
							30 = {
								change_pc = pc_dark_fractured_ae
							}
							10 = {
								change_pc = pc_dark_fractured_ae_unstable
							}
						}
					}
				}
				else_if = {
					limit = { 
						OR = {
							is_planet_class = pc_ringworld_tech
							is_planet_class = pc_ringworld_tech_damaged
							is_planet_class = pc_ringworld_seam
							is_planet_class = pc_ringworld_seam_damaged
							is_planet_class = pc_ringworld_habitable_damaged
						} 
					}
					spawn_ringworld_cracker_effect = yes
					change_pc = pc_acot_void_hole
					set_planet_size = 5
				}
				else = {
					random_list = {
						20 = {
							modifier = {
								factor = 0
								planet_size <= 25
							}
							change_pc = pc_acot_void_hole
						}
						40 = {
							change_pc = pc_dark_fractured_unstable
						}
						30 = {
							change_pc = pc_dark_fractured_ae
						}
						10 = {
							change_pc = pc_dark_fractured_ae_unstable
						}
					}
				}
			}
		}
		solar_system = {
			every_ship_in_system = {
				limit = {
					fleet = {
						NOR = {
							is_same_value = from
							owner = {
								is_progenitor_empires = yes
							}
						}
						solar_system = {
							is_same_value = event_target:destroyed_system
						}
					}
				}
				IF = {
					limit = {
						acot_ship_is_immune_to_lethal_attack = yes
					}
					reduce_hp = 1000000
				}
				else = {
					destroy_ship = this
				}
			}	
		}
		solar_system = {
			every_neighbor_system = {
				limit = {
					exists = owner
					any_system_planet = {
						is_star = yes
					}
					owner = {
						OR = {
							is_at_war_with = event_target:herculean_owner
							is_hostile_to = event_target:herculean_owner
						}
					}
					NOR = {
						has_star_flag = acot_star_cascade_cooldown
						has_star_flag = acot_star_cascade_primed
						has_star_flag = outergate
						any_system_megastructure = {
							is_megastructure_type = sofe_outer_gate
						}
						solar_system = {
							systems_blokkats_wont_stripmine = yes
						}
					}
				}
				set_star_flag = acot_star_cascade_primed
				random_system_planet = {
					limit = { 
						is_star = yes 
					}
					planet_event = {
						id = acot_herculean_events.5201 days = 120 random = 60
					}
				}
			}
		}
		random_system = {
			limit = {
				exists = owner
				any_system_planet = {
					is_star = yes
				}
				owner = {
					OR = {
						is_at_war_with = event_target:herculean_owner
						is_hostile_to = event_target:herculean_owner
					}
				}
				NOR = {
					has_star_flag = acot_star_cascade_cooldown
					has_star_flag = acot_star_cascade_primed
					has_star_flag = outergate
					any_system_megastructure = {
						is_megastructure_type = sofe_outer_gate
					}
				}
			}
			set_star_flag = acot_star_cascade_primed
			random_system_planet = {
				limit = { 
					is_star = yes 
				}
				planet_event = {
					id = acot_herculean_events.5201 days = 120 random = 60
				}
			}
		}
	}
}